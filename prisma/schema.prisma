generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Guild {
  id                        String                   @id @map("guild_id")
  prefix                    String?                  @map("guild_prefix")
  lang                      String?                  @map("guild_lang")
  notesLogsChannel          String?                  @map("notes_log_channel")
  modLogChannel             String?                  @map("mod_log_channel")
  voiceLogsChannel          String?                  @map("voice_logs_channel")
  tempChannels              TempChannelSettings[]
  experiences               UsersExperience[]
  textExperienceSettingsId  Int?                     @map("txt_exp_settings_id")
  voiceExperienceSettingsId Int?                     @map("vc_exp_settings_id")
  experienceNotificationsId Int?                     @map("exp_notify_id")
  Moderation                Moderation[]
  ActiveTempVoice           ActiveTempVoice[]
  textExperienceSettings    TextExperienceSettings?  @relation(fields: [textExperienceSettingsId], references: [id])
  voiceExperienceSettings   VoiceExperienceSettings? @relation(fields: [voiceExperienceSettingsId], references: [id])
  createdAt                 DateTime                 @default(now()) @map("created_at")
  updatedAt                 DateTime?                 @updatedAt @map("updated_at")

  @@index([id])
}

model TextExperienceSettings {
  id             Int     @id @map("guild_id")
  min            Int?    @map("text_experience_min")
  max            Int?    @map("text_experience_max")
  isEnabled      Boolean @map("is_text_exp_enabled")
  defaultMessage String? @map("text_default_levelup_message")
  guild          Guild[]

  @@index([id])
}

model VoiceExperienceSettings {
  id             Int     @id @map("guild_id")
  min            Int?    @map("voice_experience_min")
  max            Int?    @map("voice_experience_max")
  isEnabled      Boolean @map("is_voice_exp_enabled")
  defaultMessage String? @map("voice_default_levelup_message")
  guild          Guild[]

  @@index([id])
}

model TempChannelSettings {
  id              String            @map("channel_create_id")
  guildId         String            @map("guild_id")
  categoryId      String            @map("channel_category_id")
  categoryName    String?           @map("category_name")
  channelLimit    Int?              @map("channel_limit")
  channelName     String?           @map("channel_name")
  guild           Guild             @relation(fields: [guildId], references: [id])
  ActiveTempVoice ActiveTempVoice[]

  @@id([id, guildId, categoryId])
  @@unique([guildId, categoryId])
  @@index([guildId])
}

model Moderation {
  id          Int      @id @map("case_id")
  guildId     String   @map("guild_id")
  userId      String   @map("user_id")
  moderatorId String   @map("mod_id")
  type        String   @map("case_type")
  reason      String   @map("case_reason")
  date        DateTime @map("case_date")
  guild       Guild    @relation(fields: [guildId], references: [id])
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime? @updatedAt @map("updated_at")

  @@index([id])
}

model ActiveTempVoice {
  id                         String                       @map("channel_id")
  guildId                    String                       @map("guild_id")
  channelOwner               String                       @map("channel_owner_id")
  channelCategoryId          String                       @map("channel_category_id")
  guild                      Guild                        @relation(fields: [guildId], references: [id])
  tempChannel                TempChannelSettings          @relation(fields: [guildId, channelCategoryId], references: [guildId, categoryId])
  TrustedVoiceChannelMembers TrustedVoiceChannelMembers[]
  createdAt                  DateTime                     @default(now()) @map("created_at")
  updatedAt                  DateTime?                     @updatedAt @map("updated_at")

  @@id([id, guildId])
  @@index([id, guildId])
}

model TrustedVoiceChannelMembers {
  id             String          @map("channel_id")
  guildId        String          @map("guild_id")
  userId         String          @id @map("user_id")
  channelOwnerId String          @map("channel_owner_id")
  channelId      ActiveTempVoice @relation(fields: [id, guildId], references: [id, guildId])
  createdAt      DateTime        @default(now()) @map("created_at")
  updatedAt      DateTime?        @updatedAt @map("updated_at")
}

model UsersTempVoiceConfiguration {
  id           String   @map("user_id")
  channelName  String?  @map("channel_name")
  channelLimit Int?     @map("channel_limit")
  isLocked     Boolean? @map("is_channel_locked")

  @@id([id])
  @@index([id])
}

model UsersExperience {
  id              String @map("user_id")
  guildId         String @map("guild_id")
  voiceExperience Int    @map("vc_exp")
  textExperience  Int    @map("text_exp")
  voiceLevel      Int    @map("vc_level")
  textLevel       Int    @map("text_level")
  totalExperience Int    @map("total_exp")
  guild           Guild  @relation(fields: [guildId], references: [id])

  @@id([id, guildId])
  @@index([id, guildId])
}
